
%start passwd_file;

%%

passwd_file: passwd_record newline | passwd_file passwd_record newline ;

passwd_record: name ":" password ":" uid ":" gid ":" gecos ":" directory ":" shell ;

name: `[a-zA-Z_][-a-zA-Z0-9_]{0,31}`;

password: "*" | "x" ;

uid: /[0-9]+/;

gid: /[0-9]+/;

gecos: /[ˆ:\n]*/ ;

directory: /[ˆ:\n]+/ ;

shell: /[ˆ:\n]*/ ;

newline: "\n" ;

%%


